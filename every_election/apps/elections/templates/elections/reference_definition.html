{% extends "base.html" %}
{% block page_title %}Reference Definitions{% endblock page_title %}


{% block content %}
    <nav class="ds-table-of-contents">
        <h2>Reference Definitions</h2>
        <ul>
            <li><a href="#election-identifier-reference">Election Identifier Reference</a></li>
            <li><a href="#by-election-reasons">By-Election Reason Definition Reference</a></li>
        </ul>
    </nav>


    <h2 id="election-identifier-reference">Election Identifier Reference</h2>
    <p>An election code starts with an election type string. It may optionally
        contain descriptors for election subtype, organisation and division
        The identifier is terminated with the date that the polls open
        (in ISO 8601 format) for that particular election.
        Each section is separated by a period character ('.').
        Names are slugified with hyphens ('-') separating tokens.
        An optional segment is used to indicate by-elections</p>

    <p>All characters used are URL-friendly lowercase unreserved characters --
        i.e. RFC3986 unreserved characters = ALPHA / DIGIT / "-" / "." / "_" / "~",
        where ALPHA is [a-z] and DIGIT is [0-9].</p>

    <p>Examples of this could be
        <code>federal.2025-04-28</code> or
        <code>provincial.ontario.toronto-danforth.by.2023-03-27</code>
    </p>

    <h3>Segments</h3>
    <table class="ds-table">
        <tr>
            <td><strong>Election type</strong></td><td>Required, text</td>
        </tr>
        <tr>
            <td><strong>Election subtype</strong></td><td>Optional, text</td>
        </tr>
        <tr>
            <td><strong>Organisation</strong></td><td>Optional, text</td>
        </tr>
        <tr>
            <td><strong>Division</strong></td><td>Optional, text</td>
        </tr>
        <tr>
            <td><strong>By-election</strong></td><td>Optional, text</td>
        </tr>
        <tr>
            <td><strong>Date polls open</strong></td>
            <td>Required, (ISO 8601 format date)</td>
        </tr>
    </table>

    <h4>Election type</h4>
    <p>All election identifiers must include an election type.
        This describes the type of elected office that will be held
        by the winner(s) of this election.</p>

    <h4>Election subtype</h4>
    <p>Subtypes are used when an official body elects members
        by different methods. In this case, elections are split into
        sub-elections based on voting system.</p>

    <h4>Organisation</h4>
    <p>An administrative body which can hold an election.</p>

    <p>When an election type only covers a single organisation the
        organisation segment of the ID is excluded. For example, federal
        elections omit the organisation segment since there is only one
        federal parliament.</p>

    <p>Organisation segments must use official names. For provincial and
        territorial elections, this is the province or territory name
        (e.g., <code>ontario</code>, <code>british-columbia</code>, <code>yukon</code>).
        For municipal elections, this is the municipality name
        (e.g., <code>toronto</code>, <code>vancouver</code>).
    </p>

    <h4>Division</h4>
    <p>A sub-part of an organisation that a candidate can be elected
        to represent. This could be a ward in the case of a municipal election
        or an electoral district (riding) in the case of a federal or
        provincial election.</p>

    <p>Division segments must use names as they appear in official sources.
        For federal electoral districts, names are sourced from Elections Canada.
        Provincial and territorial electoral district names come from the
        respective provincial/territorial electoral bodies.</p>

    <h4>By-election</h4>
    <p>By-elections are indicated with the segment <code>by</code>.</p>

    <h3>Identifier Types</h3>
    <div class="ds-table">
        <table>
            <tr>
                <th>Type</th>
                <th>Subtype</th>
                <th>Slug</th>
                <th>Organisations</th>
                <th>Divisions</th>
            </tr>
            {% for record in election_types %}
                <tr>
                    <td>{{ record.name }}</td>
                    <td>{{ record.subtype.name }}</td>
                    <td>
                        <code>{{ record.slug }}{% if record.subtype.election_subtype %}.{{ record.subtype.election_subtype }}{% endif %}</code>
                    </td>
                    <td align="center">{% if record.can_have_orgs %}✔️{% else %}&nbsp;{% endif %}</td>
                    <td align="center">{% if record.can_have_divs %}✔️{% else %}&nbsp;{% endif %}</td>
                </tr>
            {% endfor %}
        </table>
    </div>

    <h3>Hierarchy</h3>
    <p>Election ids are hierarchical. The lowest level (or most detailed)
        identifer for an election type is called the ballot id and describes
        a single ballot paper. Each level above this is a group id.</p>

    <p>For example, the ballot id<br />
        <code>provincial.ontario.toronto-danforth.2022-06-02</code> is a child of the (organisation) group<br />
        <code>provincial.ontario.2022-06-02</code> which is in turn a child of the (election) group<br />
        <code>provincial.2022-06-02</code></p>

    <p>Similarly, the ballot id<br />
        <code>municipal.toronto.ward-10.2022-10-24</code> is a child of the (organisation) group<br />
        <code>municipal.toronto.2022-10-24</code> which is in turn a child of the (election) group<br />
        <code>municipal.2022-10-24</code></p>

    <p>The <code>by</code> segment only applies to a ballot id, so<br />
        <code>federal.toronto-centre.by.2024-06-24</code> is a child of <br />
        <code>federal.2024-06-24</code>. The group id does not include the
        <code>by</code> segment, even if all of its children are by-elections.
    </p>

    <h3>Implementations</h3>
    <p>The <code>ca_election_ids</code> module in this project provides a builder
        object, slugging algorithm, and validation rules for creating identifiers
        that conform to this specification for Canadian elections.
    </p>
    <h2 id="by-election-reasons">By-Election Reason Definition Reference</h2>

    <p>
        There are various reasons why a by-election may be triggered.
        Not all of these can be applied to all election types.
        For example, a recall petition applies to federal elections,
        while other reasons may be specific to provincial or municipal contexts.
    </p>
    <div class="ds-table">
        <table>
            <thead>
                <tr>
                    <th>Code</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                {% for code, description in by_election_reasons %}
                    {% if code %}
                        <tr>
                            <td><code>{{ code }}</code></td>
                            <td>{{ description }}</td>
                        </tr>
                    {% endif %}
                {% endfor %}
                <tr>
                    <td><code>NOT_APPLICABLE</code>*</td>
                    <td>Neither a by-election nor a ballot</td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="2">
                        <small>*<code>NOT_APPLICABLE</code> <i>is represented as an empty string in the API.</i></small>
                    </td>
                </tr>
            </tfoot>
        </table>
    </div>





{% endblock content %}
